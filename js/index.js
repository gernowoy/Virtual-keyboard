const oneLineBtn = [
  {
    key: 'Backquote',
    rus: {
      keyDown: 'ё',
      keyUp: 'Ё',
      caps: 'Ё',
      capsShift: 'ё',
    },
    eng: {
      keyDown: '`',
      keyUp: '~',
      caps: '`',
      capsShift: '~',
    },
  },
  {
    key: 'Digit1',
    rus: {
      keyDown: '1',
      keyUp: '!',
      caps: '1',
      capsShift: '!',
    },
    eng: {
      keyDown: '1',
      keyUp: '!',
      caps: '1',
      capsShift: '!',
    },
  },
  {
    key: 'Digit2',
    rus: {
      keyDown: '2',
      keyUp: '"',
      caps: '2',
      capsShift: '"',
    },
    eng: {
      keyDown: '2',
      keyUp: '@',
      caps: '2',
      capsShift: '@',
    },
  },
  {
    key: 'Digit3',
    rus: {
      keyDown: '3',
      keyUp: '№',
      caps: '3',
      capsShift: '№',
    },
    eng: {
      keyDown: '3',
      keyUp: '#',
      caps: '3',
      capsShift: '#',
    },
  },
  {
    key: 'Digit4',
    rus: {
      keyDown: '4',
      keyUp: ';',
      caps: '4',
      capsShift: ';',
    },
    eng: {
      keyDown: '4',
      keyUp: '$',
      caps: '4',
      capsShift: '$',
    },
  },
  {
    key: 'Digit5',
    rus: {
      keyDown: '5',
      keyUp: '%',
      caps: '5',
      capsShift: '%',
    },
    eng: {
      keyDown: '5',
      keyUp: '%',
      caps: '5',
      capsShift: '%',
    },
  },
  {
    key: 'Digit6',
    rus: {
      keyDown: '6',
      keyUp: ':',
      caps: '6',
      capsShift: ':',
    },
    eng: {
      keyDown: '6',
      keyUp: '^',
      caps: '6',
      capsShift: '^',
    },
  },
  {
    key: 'Digit7',
    rus: {
      keyDown: '7',
      keyUp: '?',
      caps: '7',
      capsShift: '?',
    },
    eng: {
      keyDown: '7',
      keyUp: '&',
      caps: '7',
      capsShift: '&',
    },
  },
  {
    key: 'Digit8',
    rus: {
      keyDown: '8',
      keyUp: '*',
      caps: '8',
      capsShift: '*',
    },
    eng: {
      keyDown: '8',
      keyUp: '*',
      caps: '8',
      capsShift: '*',
    },
  },
  {
    key: 'Digit9',
    rus: {
      keyDown: '9',
      keyUp: '(',
      caps: '9',
      capsShift: '(',
    },
    eng: {
      keyDown: '9',
      keyUp: '(',
      caps: '9',
      capsShift: '(',
    },
  },
  {
    key: 'Digit0',
    rus: {
      keyDown: '0',
      keyUp: ')',
      caps: '0',
      capsShift: ')',
    },
    eng: {
      keyDown: '0',
      keyUp: ')',
      caps: '0',
      capsShift: ')',
    },
  },
  {
    key: 'Minus',
    rus: {
      keyDown: '-',
      keyUp: '_',
      caps: '-',
      capsShift: '_',
    },
    eng: {
      keyDown: '-',
      keyUp: '_',
      caps: '-',
      capsShift: '_',
    },
  },
  {
    key: 'Equal',
    rus: {
      keyDown: '=',
      keyUp: '+',
      caps: '=',
      capsShift: '+',
    },
    eng: {
      keyDown: '=',
      keyUp: '+',
      caps: '=',
      capsShift: '+',
    },
  },
  {
    key: 'Backspace',
    rus: {
      keyDown: 'Backspace',
      keyUp: 'Backspace',
      caps: 'Backspace',
      capsShift: 'Backspace',
    },
    eng: {
      keyDown: 'Backspace',
      keyUp: 'Backspace',
      caps: 'Backspace',
      capsShift: 'Backspace',
    },
  },
];
const twoLineBtn = [
  {
    key: 'Tab',
    rus: {
      keyDown: 'Tab',
      keyUp: 'Tab',
      caps: 'Tab',
      capsShift: 'Tab',
    },
    eng: {
      keyDown: 'Tab',
      keyUp: 'Tab',
      caps: 'Tab',
      capsShift: 'Tab',
    },
  },
  {
    key: 'KeyQ',
    rus: {
      keyDown: 'й',
      keyUp: 'Й',
      caps: 'Й',
      capsShift: 'й',
    },
    eng: {
      keyDown: 'q',
      keyUp: 'Q',
      caps: 'Q',
      capsShift: 'q',
    },
  },
  {
    key: 'KeyW',
    rus: {
      keyDown: 'ц',
      keyUp: 'Ц',
      caps: 'Ц',
      capsShift: 'ц',
    },
    eng: {
      keyDown: 'w',
      keyUp: 'W',
      caps: 'W',
      capsShift: 'w',
    },
  },
  {
    key: 'KeyE',
    rus: {
      keyDown: 'у',
      keyUp: 'У',
      caps: 'У',
      capsShift: 'у',
    },
    eng: {
      keyDown: 'e',
      keyUp: 'E',
      caps: 'E',
      capsShift: 'e',
    },
  },
  {
    key: 'KeyR',
    rus: {
      keyDown: 'к',
      keyUp: 'К',
      caps: 'К',
      capsShift: 'к',
    },
    eng: {
      keyDown: 'r',
      keyUp: 'R',
      caps: 'R',
      capsShift: 'r',
    },
  },
  {
    key: 'KeyT',
    rus: {
      keyDown: 'е',
      keyUp: 'Е',
      caps: 'Е',
      capsShift: 'е',
    },
    eng: {
      keyDown: 't',
      keyUp: 'T',
      caps: 'T',
      capsShift: 't',
    },
  },
  {
    key: 'KeyY',
    rus: {
      keyDown: 'н',
      keyUp: 'Н',
      caps: 'Н',
      capsShift: 'н',
    },
    eng: {
      keyDown: 'y',
      keyUp: 'Y',
      caps: 'Y',
      capsShift: 'y',
    },
  },
  {
    key: 'KeyU',
    rus: {
      keyDown: 'г',
      keyUp: 'Г',
      caps: 'Г',
      capsShift: 'г',
    },
    eng: {
      keyDown: 'u',
      keyUp: 'U',
      caps: 'U',
      capsShift: 'u',
    },
  },
  {
    key: 'KeyI',
    rus: {
      keyDown: 'ш',
      keyUp: 'Ш',
      caps: 'Ш',
      capsShift: 'ш',
    },
    eng: {
      keyDown: 'i',
      keyUp: 'I',
      caps: 'I',
      capsShift: 'i',
    },
  },
  {
    key: 'KeyO',
    rus: {
      keyDown: 'щ',
      keyUp: 'Щ',
      caps: 'Щ',
      capsShift: 'щ',
    },
    eng: {
      keyDown: 'o',
      keyUp: 'O',
      caps: 'O',
      capsShift: 'o',
    },
  },
  {
    key: 'KeyP',
    rus: {
      keyDown: 'з',
      keyUp: 'З',
      caps: 'З',
      capsShift: 'з',
    },
    eng: {
      keyDown: 'p',
      keyUp: 'P',
      caps: 'P',
      capsShift: 'p',
    },
  },
  {
    key: 'BracketLeft',
    rus: {
      keyDown: 'х',
      keyUp: 'Х',
      caps: 'Х',
      capsShift: 'х',
    },
    eng: {
      keyDown: '[',
      keyUp: '{',
      caps: '[',
      capsShift: '{',
    },
  },
  {
    key: 'BracketRight',
    rus: {
      keyDown: 'ъ',
      keyUp: 'Ъ',
      caps: 'Ъ',
      capsShift: 'ъ',
    },
    eng: {
      keyDown: ']',
      keyUp: '}',
      caps: ']',
      capsShift: '}',
    },
  },
  {
    key: 'Backslash',
    rus: {
      keyDown: '\\',
      keyUp: '/',
      caps: '\\',
      capsShift: '/',
    },
    eng: {
      keyDown: '\\',
      keyUp: '|',
      caps: '\\',
      capsShift: '|',
    },
  },
  {
    key: 'Delete',
    rus: {
      keyDown: 'Del',
      keyUp: 'Del',
      caps: 'Del',
      capsShift: 'Del',
    },
    eng: {
      keyDown: 'Del',
      keyUp: 'Del',
      caps: 'Del',
      capsShift: 'Del',
    },
  },
];
const threeLineBtn = [
  {
    key: 'CapsLock',
    rus: {
      keyDown: 'CapsLock',
      keyUp: 'CapsLock',
      caps: 'CapsLock',
      capsShift: 'CapsLock',
    },
    eng: {
      keyDown: 'CapsLock',
      keyUp: 'CapsLock',
      caps: 'CapsLock',
      capsShift: 'CapsLock',
    },
  },
  {
    key: 'KeyA',
    rus: {
      keyDown: 'ф',
      keyUp: 'Ф',
      caps: 'Ф',
      capsShift: 'ф',
    },
    eng: {
      keyDown: 'a',
      keyUp: 'A',
      caps: 'A',
      capsShift: 'a',
    },
  },
  {
    key: 'KeyS',
    rus: {
      keyDown: 'ы',
      keyUp: 'Ы',
      caps: 'Ы',
      capsShift: 'ы',
    },
    eng: {
      keyDown: 's',
      keyUp: 'S',
      caps: 'S',
      capsShift: 's',
    },
  },
  {
    key: 'KeyD',
    rus: {
      keyDown: 'в',
      keyUp: 'В',
      caps: 'В',
      capsShift: 'в',
    },
    eng: {
      keyDown: 'd',
      keyUp: 'D',
      caps: 'D',
      capsShift: 'd',
    },
  },
  {
    key: 'KeyF',
    rus: {
      keyDown: 'а',
      keyUp: 'А',
      caps: 'А',
      capsShift: 'а',
    },
    eng: {
      keyDown: 'f',
      keyUp: 'F',
      caps: 'F',
      capsShift: 'f',
    },
  },
  {
    key: 'KeyG',
    rus: {
      keyDown: 'п',
      keyUp: 'П',
      caps: 'П',
      capsShift: 'п',
    },
    eng: {
      keyDown: 'g',
      keyUp: 'G',
      caps: 'G',
      capsShift: 'g',
    },
  },
  {
    key: 'KeyH',
    rus: {
      keyDown: 'р',
      keyUp: 'Р',
      caps: 'Р',
      capsShift: 'р',
    },
    eng: {
      keyDown: 'h',
      keyUp: 'H',
      caps: 'H',
      capsShift: 'h',
    },
  },
  {
    key: 'KeyJ',
    rus: {
      keyDown: 'о',
      keyUp: 'О',
      caps: 'О',
      capsShift: 'о',
    },
    eng: {
      keyDown: 'j',
      keyUp: 'J',
      caps: 'J',
      capsShift: 'j',
    },
  },
  {
    key: 'KeyK',
    rus: {
      keyDown: 'л',
      keyUp: 'Л',
      caps: 'Л',
      capsShift: 'л',
    },
    eng: {
      keyDown: 'k',
      keyUp: 'K',
      caps: 'K',
      capsShift: 'k',
    },
  },
  {
    key: 'KeyL',
    rus: {
      keyDown: 'д',
      keyUp: 'Д',
      caps: 'Д',
      capsShift: 'д',
    },
    eng: {
      keyDown: 'l',
      keyUp: 'L',
      caps: 'L',
      capsShift: 'l',
    },
  },
  {
    key: 'Semicolon',
    rus: {
      keyDown: 'ж',
      keyUp: 'Ж',
      caps: 'Ж',
      capsShift: 'ж',
    },
    eng: {
      keyDown: ';',
      keyUp: ':',
      caps: ';',
      capsShift: ':',
    },
  },
  {
    key: 'Quote',
    rus: {
      keyDown: 'э',
      keyUp: 'Э',
      caps: 'Э',
      capsShift: 'э',
    },
    eng: {
      keyDown: "'",
      keyUp: '"',
      caps: "'",
      capsShift: '"',
    },
  },
  {
    key: 'Enter',
    rus: {
      keyDown: 'Enter',
      keyUp: 'Enter',
      caps: 'Enter',
      capsShift: 'Enter',
    },
    eng: {
      keyDown: 'Enter',
      keyUp: 'Enter',
      caps: 'Enter',
      capsShift: 'Enter',
    },
  },
];
const fourLineBtn = [
  {
    key: 'ShiftLeft',
    rus: {
      keyDown: 'Shift',
      keyUp: 'Shift',
      caps: 'Shift',
      capsShift: 'Shift',
    },
    eng: {
      keyDown: 'Shift',
      keyUp: 'Shift',
      caps: 'Shift',
      capsShift: 'Shift',
    },
  },
  {
    key: 'KeyZ',
    rus: {
      keyDown: 'я',
      keyUp: 'Я',
      caps: 'Я',
      capsShift: 'я',
    },
    eng: {
      keyDown: 'z',
      keyUp: 'Z',
      caps: 'Z',
      capsShift: 'z',
    },
  },
  {
    key: 'KeyX',
    rus: {
      keyDown: 'ч',
      keyUp: 'Ч',
      caps: 'Ч',
      capsShift: 'ч',
    },
    eng: {
      keyDown: 'x',
      keyUp: 'X',
      caps: 'X',
      capsShift: 'x',
    },
  },
  {
    key: 'KeyC',
    rus: {
      keyDown: 'с',
      keyUp: 'С',
      caps: 'С',
      capsShift: 'с',
    },
    eng: {
      keyDown: 'c',
      keyUp: 'C',
      caps: 'C',
      capsShift: 'c',
    },
  },
  {
    key: 'KeyV',
    rus: {
      keyDown: 'м',
      keyUp: 'М',
      caps: 'М',
      capsShift: 'м',
    },
    eng: {
      keyDown: 'v',
      keyUp: 'V',
      caps: 'V',
      capsShift: 'v',
    },
  },
  {
    key: 'KeyB',
    rus: {
      keyDown: 'и',
      keyUp: 'И',
      caps: 'И',
      capsShift: 'и',
    },
    eng: {
      keyDown: 'b',
      keyUp: 'B',
      caps: 'B',
      capsShift: 'b',
    },
  },
  {
    key: 'KeyN',
    rus: {
      keyDown: 'т',
      keyUp: 'Т',
      caps: 'Т',
      capsShift: 'т',
    },
    eng: {
      keyDown: 'n',
      keyUp: 'N',
      caps: 'N',
      capsShift: 'n',
    },
  },
  {
    key: 'KeyM',
    rus: {
      keyDown: 'ь',
      keyUp: 'Ь',
      caps: 'Ь',
      capsShift: 'ь',
    },
    eng: {
      keyDown: 'm',
      keyUp: 'M',
      caps: 'M',
      capsShift: 'm',
    },
  },
  {
    key: 'Comma',
    rus: {
      keyDown: 'б',
      keyUp: 'Б',
      caps: 'Б',
      capsShift: 'б',
    },
    eng: {
      keyDown: ',',
      keyUp: '<',
      caps: ',',
      capsShift: '<',
    },
  },
  {
    key: 'Period',
    rus: {
      keyDown: 'ю',
      keyUp: 'Ю',
      caps: 'Ю',
      capsShift: 'ю',
    },
    eng: {
      keyDown: '.',
      keyUp: '>',
      caps: '.',
      capsShift: '>',
    },
  },
  {
    key: 'Slash',
    rus: {
      keyDown: '.',
      keyUp: ',',
      caps: '.',
      capsShift: ',',
    },
    eng: {
      keyDown: '/',
      keyUp: '?',
      caps: '/',
      capsShift: '?',
    },
  },
  {
    key: 'ArrowUp',
    rus: {
      keyDown: '↑',
      keyUp: '↑',
      caps: '↑',
      capsShift: '↑',
    },
    eng: {
      keyDown: '↑',
      keyUp: '↑',
      caps: '↑',
      capsShift: '↑',
    },
  },
  {
    key: 'ShiftRight',
    rus: {
      keyDown: 'Shift',
      keyUp: 'Shift',
      caps: 'Shift',
      capsShift: 'Shift',
    },
    eng: {
      keyDown: 'Shift',
      keyUp: 'Shift',
      caps: 'Shift',
      capsShift: 'Shift',
    },
  },
];
const fiveLineBtn = [
  {
    key: 'ControlLeft',
    rus: {
      keyDown: 'Ctrl',
      keyUp: 'Ctrl',
      caps: 'Ctrl',
      capsShift: 'Ctrl',
    },
    eng: {
      keyDown: 'Ctrl',
      keyUp: 'Ctrl',
      caps: 'Ctrl',
      capsShift: 'Ctrl',
    },
  },
  {
    key: 'MetaLeft',
    rus: {
      keyDown: 'Win',
      keyUp: 'Win',
      caps: 'Win',
      capsShift: 'Win',
    },
    eng: {
      keyDown: 'Win',
      keyUp: 'Win',
      caps: 'Win',
      capsShift: 'Win',
    },
  },
  {
    key: 'AltLeft',
    rus: {
      keyDown: 'Alt',
      keyUp: 'Alt',
      caps: 'Alt',
      capsShift: 'Alt',
    },
    eng: {
      keyDown: 'Alt',
      keyUp: 'Alt',
      caps: 'Alt',
      capsShift: 'Alt',
    },
  },
  {
    key: 'Space',
    rus: {
      keyDown: ' ',
      keyUp: ' ',
      caps: ' ',
      capsShift: ' ',
    },
    eng: {
      keyDown: ' ',
      keyUp: ' ',
      caps: ' ',
      capsShift: ' ',
    },
  },
  {
    key: 'AltRight',
    rus: {
      keyDown: 'Alt',
      keyUp: 'Alt',
      caps: 'Alt',
      capsShift: 'Alt',
    },
    eng: {
      keyDown: 'Alt',
      keyUp: 'Alt',
      caps: 'Alt',
      capsShift: 'Alt',
    },
  },
  {
    key: 'ArrowLeft',
    rus: {
      keyDown: '←',
      keyUp: '←',
      caps: '←',
      capsShift: '←',
    },
    eng: {
      keyDown: '←',
      keyUp: '←',
      caps: '←',
      capsShift: '←',
    },
  },
  {
    key: 'ArrowDown',
    rus: {
      keyDown: '↓',
      keyUp: '↓',
      caps: '↓',
      capsShift: '↓',
    },
    eng: {
      keyDown: '↓',
      keyUp: '↓',
      caps: '↓',
      capsShift: '↓',
    },
  },
  {
    key: 'ArrowRight',
    rus: {
      keyDown: '→',
      keyUp: '→',
      caps: '→',
      capsShift: '→',
    },
    eng: {
      keyDown: '→',
      keyUp: '→',
      caps: '→',
      capsShift: '→',
    },
  },
  {
    key: 'ControlRight',
    rus: {
      keyDown: 'Ctrl',
      keyUp: 'Ctrl',
      caps: 'Ctrl',
      capsShift: 'Ctrl',
    },
    eng: {
      keyDown: 'Ctrl',
      keyUp: 'Ctrl',
      caps: 'Ctrl',
      capsShift: 'Ctrl',
    },
  },
];

function addDom() {
  const content = document.createElement('div');
  content.classList.add('content');

  const taskname = document.createElement('p');
  taskname.classList.add('taskname');
  taskname.innerHTML = 'Virtual keyboard';

  const textArea = document.createElement('textarea');
  textArea.classList.add('textarea');
  [textArea.name, textArea.id, textArea.cols, textArea.rows] = ['textarea', 'textarea', '50', '10'];

  function addKeyboard() {
    function addKeyboardLine(Array) {
      const divKeyboardLine = document.createElement('div');
      divKeyboardLine.classList.add('keyboard-line');
      function addKeyboardBtn(key) {
        const keyboardBtn = document.createElement('div');
        keyboardBtn.classList.add('keyboard-btn');
        keyboardBtn.classList.add(key.key);

        const ruText = document.createElement('span');
        ruText.classList.add('rus');

        const keyDownRuText = document.createElement('span');
        keyDownRuText.classList.add('keyDown');
        keyDownRuText.innerHTML = key.rus.keyDown;

        const keyUpRuText = document.createElement('span');
        keyUpRuText.classList.add('keyUp');
        keyUpRuText.classList.add('hidden');
        keyUpRuText.innerHTML = key.rus.keyUp;

        const capsRuText = document.createElement('span');
        capsRuText.classList.add('caps');
        capsRuText.classList.add('hidden');
        capsRuText.innerHTML = key.rus.caps;

        const capsShiftRuText = document.createElement('span');
        capsShiftRuText.classList.add('capsShift');
        capsShiftRuText.classList.add('hidden');
        capsShiftRuText.innerHTML = key.rus.capsShift;

        ruText.append(keyDownRuText);
        ruText.append(keyUpRuText);
        ruText.append(capsRuText);
        ruText.append(capsShiftRuText);

        const enText = document.createElement('span');
        enText.classList.add('eng');

        const keyDownEnText = document.createElement('span');
        keyDownEnText.classList.add('keyDown');
        keyDownEnText.innerHTML = key.eng.keyDown;

        const keyUpEnText = document.createElement('span');
        keyUpEnText.classList.add('keyUp');
        keyUpEnText.classList.add('hidden');
        keyUpEnText.innerHTML = key.eng.keyUp;

        const capsEnText = document.createElement('span');
        capsEnText.classList.add('caps');
        capsEnText.classList.add('hidden');
        capsEnText.innerHTML = key.eng.caps;

        const capsShiftEnText = document.createElement('span');
        capsShiftEnText.classList.add('capsShift');
        capsShiftEnText.classList.add('hidden');
        capsShiftEnText.innerHTML = key.eng.capsShift;

        enText.append(keyDownEnText);
        enText.append(keyUpEnText);
        enText.append(capsEnText);
        enText.append(capsShiftEnText);

        const language = localStorage.getItem('lang') === null ? 'rus' : localStorage.getItem('lang');

        if (language === 'eng') {
          ruText.classList.add('hidden');
          keyDownRuText.classList.add('hidden');
        } else if (language === 'rus') {
          enText.classList.add('hidden');
          keyDownEnText.classList.add('hidden');
        }

        keyboardBtn.append(ruText);
        keyboardBtn.append(enText);

        return keyboardBtn;
      }

      for (let i = 0; i < Array.length; i += 1) {
        const key = addKeyboardBtn(Array[i]);
        divKeyboardLine.append(key);
      }

      return divKeyboardLine;
    }

    const keyboard = document.createElement('div');
    keyboard.classList.add('keyboard');
    keyboard.id = 'keyboard';

    // eslint-disable-next-line no-undef
    [firstRow, secondRow, thirdRow, fourthRow, fifthRow] = [
      addKeyboardLine(oneLineBtn),
      addKeyboardLine(twoLineBtn),
      addKeyboardLine(threeLineBtn),
      addKeyboardLine(fourLineBtn),
      addKeyboardLine(fiveLineBtn),
    ];

    // eslint-disable-next-line no-undef
    const KeyboardRows = [firstRow, secondRow, thirdRow, fourthRow, fifthRow];
    for (let i = 0; i < KeyboardRows.length; i += 1) {
      keyboard.append(KeyboardRows[i]);
    }

    return keyboard;
  }

  const description = document.createElement('p');
  description.classList.add('description');
  description.innerHTML = 'Made on Windows. Press Ctrl + Alt (left-side both) to change language';

  document.body.append(content);
  content.append(taskname);
  content.append(textArea);
  content.append(addKeyboard());
  content.append(description);
  textArea.setAttribute('spellcheck', 'false');
  textArea.focus();
}

function isEng() {
  return document.querySelector('.rus').classList.contains('hidden');
}

function getLangLetters() {
  return isEng() ? document.querySelectorAll('.eng') : document.querySelectorAll('.rus');
}

const btnStatus = {
  keyDown: { value: 1, name: 'keyDown', selector: '.keyDown' },
  keyUp: { value: 2, name: 'keyUp', selector: '.keyUp' },
  caps: { value: 3, name: 'caps', selector: '.caps' },
  capsShift: { value: 4, name: 'capsShift', selector: '.capsShift' },
};

function getActiveStatus() {
  const btnDownText = getLangLetters()[0].querySelector('.keyDown');
  if (!btnDownText.classList.contains('hidden')) return btnStatus.keyDown;
  const btnUpText = getLangLetters()[0].querySelector('.keyUp');
  if (!btnUpText.classList.contains('hidden')) return btnStatus.keyUp;
  const capsText = getLangLetters()[0].querySelector('.caps');
  if (!capsText.classList.contains('hidden')) return btnStatus.caps;
  const capsShiftText = getLangLetters()[0].querySelector('.capsShift');
  if (!capsShiftText.classList.contains('hidden')) return btnStatus.capsShift;
  return '';
}

function changeStatus(status) {
  const currentStatus = getActiveStatus();
  const activeLetters = getLangLetters();

  if (JSON.stringify(currentStatus) === JSON.stringify(status)) {
    return;
  }
  activeLetters.forEach((item) => {
    item.querySelector(status.selector).classList.remove('hidden');
    item.querySelector(currentStatus.selector).classList.add('hidden');
  });
}

function isShiftOn() {
  return (document.querySelector('.ShiftLeft').classList.contains('active') || document.querySelector('.ShiftRight').classList.contains('active')
  );
}

function capsLockOff() {
  if (isShiftOn()) {
    changeStatus(btnStatus.keyUp);
  } else {
    changeStatus(btnStatus.keyDown);
  }
}

function capsLockOn() {
  if (isShiftOn()) {
    changeStatus(btnStatus.capsShift);
  } else {
    changeStatus(btnStatus.caps);
  }
}

function isCapsOn() {
  return document.querySelector('.CapsLock').classList.contains('active');
}

function shiftOff() {
  if (isCapsOn()) {
    changeStatus(btnStatus.caps);
  } else {
    changeStatus(btnStatus.keyDown);
  }
}

function shiftOn() {
  if (isCapsOn()) {
    changeStatus(btnStatus.capsShift);
  } else {
    changeStatus(btnStatus.keyUp);
  }
}

function getAllLangLetters() {
  function getPassiveLetters() {
    return isEng() ? document.querySelectorAll('.rus') : document.querySelectorAll('.eng');
  }

  const activeLetters = getLangLetters();
  const passiveLetters = getPassiveLetters();

  return { activeLetters, passiveLetters };
}

function changeLang() {
  const allLangLetters = getAllLangLetters();
  const symbolStatus = getActiveStatus();

  allLangLetters.activeLetters.forEach((item) => {
    item.classList.add('hidden');
    item.querySelector(symbolStatus.selector).classList.add('hidden');
  });

  allLangLetters.passiveLetters.forEach((item) => {
    item.classList.remove('hidden');
    item.querySelector(symbolStatus.selector).classList.remove('hidden');
  });

  if (isEng()) {
    localStorage.setItem('lang', 'eng');
  } else {
    localStorage.setItem('lang', 'rus');
  }
}

addDom();

const textarea = document.getElementById('textarea');
const keyboard = document.getElementById('keyboard');

textarea.addEventListener('keydown', (event) => {
  event.preventDefault();
});

document.addEventListener('keydown', (event) => {
  const key = document.querySelector(`.keyboard-btn.${event.code}`);
  const booleanKey = !!key;

  if (booleanKey) {
    if (event.ctrlKey && event.altKey) {
      changeLang();
    }

    if (event.code !== 'CapsLock') {
      key.classList.add('active');
    }

    if (event.key === 'Shift') {
      shiftOn();
    } else if (event.code === 'CapsLock') {
      if (isCapsOn()) {
        key.classList.remove('active');
        capsLockOff();
      } else {
        key.classList.add('active');
        capsLockOn();
      }
    } else if (event.code === 'Tab') {
      textarea.setRangeText('\t', textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    } else if (event.code === 'Enter') {
      textarea.setRangeText('\n', textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    } else if (event.code === 'Delete') {
      textarea.setRangeText('', textarea.selectionStart, textarea.selectionEnd + 1, 'start');
    } else if (event.code === 'Backspace') {
      if (textarea.selectionStart > 0) {
        textarea.setRangeText('', textarea.selectionStart - 1, textarea.selectionEnd, 'start');
      }
    } else if (event.code === 'Space') {
      textarea.setRangeText(event.key, textarea.selectionStart, textarea.selectionEnd, 'end');
    } else if (event.key === 'Meta' || event.key === 'Alt' || event.key === 'AltGraph' || event.key === 'Control') {
      // continue
    } else {
      textarea.setRangeText(key.innerText, textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    }
  }
});

document.addEventListener('keyup', (event) => {
  const key = document.querySelector(`.active.${event.code}`);

  if (key !== undefined && event.code !== 'CapsLock' && key !== null) {
    key.classList.remove('active');

    if (event.key === 'Shift') {
      shiftOff();
    }
  }
});

keyboard.addEventListener('mousedown', (event) => {
  const keyboardButton = event.target.closest('.keyboard-btn');

  if (keyboardButton) {
    if (!keyboardButton.classList.contains('CapsLock')) {
      keyboardButton.classList.add('active');
    }
    if (keyboardButton.innerText === 'Shift') {
      shiftOn();
    } else if (keyboardButton.classList.contains('CapsLock')) {
      if (isCapsOn()) {
        keyboardButton.classList.remove('active');
        capsLockOff();
      } else {
        keyboardButton.classList.add('active');
        capsLockOn();
      }
    } else if (keyboardButton.classList.contains('Tab')) {
      textarea.setRangeText('\t', textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    } else if (keyboardButton.classList.contains('Enter')) {
      textarea.setRangeText('\n', textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    } else if (keyboardButton.classList.contains('Delete')) {
      textarea.setRangeText('', textarea.selectionStart, textarea.selectionEnd + 1, 'start');
      textarea.focus();
    } else if (keyboardButton.classList.contains('Backspace')) {
      if (textarea.selectionStart > 0) {
        textarea.setRangeText('', textarea.selectionStart - 1, textarea.selectionEnd, 'start');
      }
      textarea.focus();
    } else if (keyboardButton.classList.contains('Space')) {
      textarea.setRangeText(' ', textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    } else if (keyboardButton.innerText === 'Ctrl' || keyboardButton.innerText === 'Win' || keyboardButton.innerText === 'Alt') {
      // continue
    } else {
      textarea.setRangeText(keyboardButton.innerText, textarea.selectionStart, textarea.selectionEnd, 'end');
      textarea.focus();
    }
  }
});

keyboard.addEventListener('mouseup', (event) => {
  const keyboardButton = event.target.closest('.keyboard-btn');

  if (keyboardButton !== null && !keyboardButton.classList.contains('CapsLock')) {
    keyboardButton.classList.remove('active');

    if (keyboardButton.innerText === 'Shift') {
      shiftOff();
    }
  }
});
